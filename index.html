
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Truora - Validaci√≥n de Identidad</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    * {margin: 0; padding: 0; box-sizing: border-box;}
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    .container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      width: 100%;
      max-width: 500px;
      text-align: center;
    }
    .logo {
      font-size: 2.5em;
      font-weight: 700;
      background: linear-gradient(45deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #7f8c8d;
      font-size: 1.1em;
      margin-bottom: 30px;
    }
    .form-group {margin-bottom: 25px; text-align: left;}
    label {
      display: block;
      color: #2c3e50;
      font-weight: 600;
      margin-bottom: 8px;
    }
    input[type="text"], input[type="tel"] {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid #e0e6ed;
      border-radius: 12px;
      font-size: 1em;
    }
    input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    .btn-primary {
      width: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 18px 30px;
      border-radius: 12px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-dashboard {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 12px 25px;
      border-radius: 8px;
      text-decoration: none;
      display: inline-block;
      margin-top: 15px;
    }
    .btn-dashboard:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    .loading, .result { display: none; }
    .loading.show, .result.show { display: block; }
    .result.success { background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; }
    .result.warning { background: linear-gradient(135deg, #f39c12, #e67e22); color: white; }
    .result.danger { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
  </style>
</head>
<body>
<div class="container">
  <div class="logo">üîê TRUORA</div>
  <p class="subtitle">Validaci√≥n de Identidad Inteligente</p>

  <form id="validationForm" onsubmit="return false;">
    <div class="form-group">
      <label for="nombre">Nombre completo</label>
      <input type="text" id="nombre" name="nombre" required placeholder="Ej: Juan Carlos P√©rez">
    </div>
    <div class="form-group">
      <label for="telefono">N√∫mero de tel√©fono</label>
      <input type="tel" id="telefono" name="telefono" required placeholder="Ej: +57 300 123 4567">
    </div>
    <div class="form-group">
      <label for="empresa">Empresa solicitante</label>
      <input type="text" id="empresa" name="empresa" required placeholder="Ej: ADDI">
    </div>
    <button type="submit" class="btn-primary" id="submitBtn">üöÄ Iniciar Validaci√≥n</button>
  </form>

  <div class="loading" id="loadingSection">
    <p>‚ö° Procesando validaci√≥n...</p>
    <div class="progress-bar"><div class="progress-fill" id="progressFill" style="height: 8px; background: linear-gradient(90deg, #667eea, #764ba2); width: 0%; transition: width 0.3s ease;"></div></div>
    <div class="steps">
      <div class="step" id="step1">üì± Analizando documento...</div>
      <div class="step" id="step2">ü§≥ Verificando biometr√≠a...</div>
      <div class="step" id="step3">ü§ñ Aplicando ML anti-fraude...</div>
      <div class="step" id="step4">‚úÖ Generando resultado...</div>
    </div>
  </div>

  <div class="result" id="resultSection">
    <div id="resultIcon" style="font-size: 2em; margin-bottom: 10px;"></div>
    <div id="resultTitle" style="font-size: 1.5em; font-weight: bold;"></div>
    <div id="resultDescription" style="margin-top: 10px;"></div>
    <a href="#" class="btn-dashboard" id="dashboardBtn">üìä Ver Dashboard</a>
    <button id="retryBtn" class="btn-dashboard" style="display:none; margin-left: 10px;">üîÅ Realizar otra Validaci√≥n</button>
  </div>
</div>

<script>
  const SUPABASE_URL = 'https://hsflgsnvcwwbmnmcblfv.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhzZmxnc252Y3d3Ym1ubWNibGZ2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY1NjEyNjksImV4cCI6MjA3MjEzNzI2OX0.svszpLac0yeixbjDZoq6IfP32HcwNaNQ4ue95YinH2U';
  const DASHBOARD_URL = 'https://trusty-validate-dash.lovable.app/';

  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  document.getElementById('validationForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    const nombre = document.getElementById('nombre').value;
    const telefono = document.getElementById('telefono').value;
    const empresa = document.getElementById('empresa').value;
    document.getElementById('validationForm').style.display = 'none';
    document.getElementById('loadingSection').classList.add('show');

    const { data } = await supabase.from('validaciones').insert([{ nombre, telefono, empresa, estado: 'procesando' }]).select();
    const recordId = data?.[0]?.id || null;

    const steps = [
      { id: 'step1', duration: 3000, progress: 25 },
      { id: 'step2', duration: 5000, progress: 50 },
      { id: 'step3', duration: 8000, progress: 75 },
      { id: 'step4', duration: 2000, progress: 100 }
    ];
    for (let step of steps) {
      document.getElementById(step.id).classList.add('active');
      document.getElementById('progressFill').style.width = step.progress + '%';
      await new Promise(r => setTimeout(r, step.duration));
      document.getElementById(step.id).classList.remove('active');
    }

    const resultados = [
      { tipo: 'success', icon: '‚úÖ', titulo: 'APROBADO', descripcion: `${nombre} ha sido validado exitosamente.` },
      { tipo: 'warning', icon: '‚ö†Ô∏è', titulo: 'REVISI√ìN MANUAL', descripcion: `${nombre} requiere verificaci√≥n adicional.` },
      { tipo: 'danger', icon: '‚ùå', titulo: 'RECHAZADO', descripcion: `Validaci√≥n de ${nombre} rechazada.` }
    ];
    const resultado = resultados[Math.floor(Math.random() * resultados.length)];

    if (recordId) {
      await supabase.from('validaciones').update({ estado: 'completado', resultado: resultado.titulo.toLowerCase() }).eq('id', recordId);
    }

    document.getElementById('loadingSection').classList.remove('show');
    const resultSection = document.getElementById('resultSection');
    resultSection.className = `result show ${resultado.tipo}`;
    document.getElementById('resultIcon').textContent = resultado.icon;
    document.getElementById('resultTitle').textContent = resultado.titulo;
    document.getElementById('resultDescription').textContent = resultado.descripcion;
    document.getElementById('dashboardBtn').href = DASHBOARD_URL;
    document.getElementById('retryBtn').style.display = 'inline-block';
  });

  document.getElementById('retryBtn').addEventListener('click', () => {
    document.getElementById('resultSection').classList.remove('show');
    document.getElementById('validationForm').reset();
    document.getElementById('validationForm').style.display = 'block';
    document.getElementById('progressFill').style.width = '0%';
  });
</script>
</body>
</html>





